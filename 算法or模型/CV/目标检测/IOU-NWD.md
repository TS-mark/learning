# IOU汇总

## A Normalized Gaussian Wasserstein Distance for Tiny Object Detection


小目标(TOD,tiny objection detection)在许多现实世界的应用中无处不在，包括驾驶辅助、大规模监控和海上救援。尽管由于深度神经网络的发展，目标检测取得了显著的进展，但大多数都是用于检测正常大小的目标。而小目标(AI-TOD数据集中小于16*16像素)往往表现出极其有限的外观信息，增加了识别特征的学习难度，导致小目标检测失败的案例非常多。

主要是计算小目标的时候，iou变化太明显了，NWD解决这个问题，很适合解决小目标的相似性


## 2.1 小目标检测
以往的小目标检测方法大致可以分为3大类:

1. 多尺度特征学习
2. 设计更好的训练策略
3. 基于GAN增强的检测
### 1、多尺度特征学习
一种简单而经典的方法是将输入图像的大小调整为不同的尺度，并训练不同的检测器，每一个检测器都能在一定的尺度范围内达到最佳性能。为了降低计算成本，一些研究尝试构建不同尺度的特征级金字塔。例如，SSD从不同分辨率的特征图中检测目标。特征金字塔网络(Feature Pyramid Network, FPN)采用横向连接的自顶向下结构，将不同尺度的特征信息结合起来，提高目标检测性能。在此基础上，提出了进一步提高FPN性能的方法，包括PANet、BiFPN、Recursive-FPN。此外，TridentNet构建了具有不同感受野的并行多分支体系结构，以生成特定比例的特征图。

### 2、更好的训练策略
Singh等人受到同时检测小目标和大目标很难的观察启发，提出了SNIP和SNIPER在一定规模范围内选择性训练目标。此外，Kim等人引入了Scale-Aware网络(SAN)，并将从不同空间提取的特征映射到一个尺度不变的子空间，使检测器对尺度变化具有更强的鲁棒性。

### 3、基于GAN增强的检测
Perceptual GAN是第一个尝试将GAN应用于小目标检测的算法，它通过缩小小目标与大目标的表示差异来改进小目标检测。此外，Bai等人提出了一种MT-GAN来训练图像级超分辨率模型，以增强小ROI的特征。此外，有研究提出了一种特征超分辨率方法来提高基于建议检测器的小目标检测性能。

## 2.2目标检测中的评价指标
IoU是度量边界框之间相似性的最广泛使用的度量方法。然而，IoU只能在边界框有重叠情况下的问题。为了解决这一问题，提出了一种Generalized IoU (GIoU)的方法，该方法通过最小外接边界框相关的惩罚项来实现。然而，当一个边界框包含另一个边界框时，GIoU将降级为IoU。因此，为了克服IoU和GIoU的局限性提出了DIoU和CIoU，它们考虑了重叠面积、中心点距离和纵横比这三个几何特性。

GIoU、CIoU和DIoU主要应用于NMS和loss function中代替IoU以提高总体目标检测性能，但在标签分配中的应用很少讨论。在相似工作中，Yang等人也提出了Gaussian Wasserstein Distance (GWD)损失用于Oriented目标检测，通过测量Oriented BBox的位置关系。然而，该方法的目的是解决Oriented目标检测中的边界不连续和square-like问题。本文的动机是为了减轻IoU对小目标位置偏差的敏感性，本文提出的方法可以在Anchor-Based的目标检测中取代IoU。

## 2.3 标签分配策略
将高质量的Anchor分配到GT小目标Box中是一项具有挑战性的任务。一个简单的方法是在选择正样本时降低IoU阈值。虽然可以使小目标匹配更多的Anchor，但训练样本的整体质量会下降。此外，最近的许多研究都试图使标签分配过程更具自适应性，以提高检测性能。例如，Zhang等人提出了自适应训练样本选择(Adaptive Training Sample Selection, ATSS)，通过一组Anchor的IoU统计值自动计算每个GT的Pos/Neg阈值。Kang等人通过假设Pos/Neg的联合损失分布服从高斯分布，引入了概率Anchor Assignment (PAA)。此外，Optimal Transport Assignment (OTA)将标签分配过程作为一个全局视角的最优运输问题。但这些方法都是利用IoU度量来度量2个BBox之间的相似性，主要关注标签分配中的阈值设置，不适合TOD。相比之下，本文的研究重点是设计一种更好的评价指标，用以替代小目标检测中的IoU指标。